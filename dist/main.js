(()=>{"use strict";const e=(()=>{const e=e=>{let t;try{t=window[e];let l="__storage_test__";return t.setItem(l,l),t.removeItem(l),!0}catch(e){return e instanceof DOMException&&(22===e.code||1014===e.code||"QuotaExceededError"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name)&&t&&0!==t.length}};return{saveData:t=>{e("localStorage")&&localStorage.setItem("todoList",JSON.stringify(t))},loadData:()=>e("localStorage")&&localStorage.getItem("todoList")?JSON.parse(localStorage.getItem("todoList")):null}})(),t=(()=>{let e=[];const t=t=>e.some((e=>e.name===t)),l=l=>{t(l)||e.push((e=>{let t=[];const l=e=>t.some((t=>t.title===e)),r=e=>{for(let l=0;l<t.length;l++)if(t[l].title===e)return l;return-1};return{name:e,tasks:t,addTask:(e,r,n)=>{l(e)||t.push(((e,t,l)=>({title:e,date:t,checked:l}))(e,r,n))},removeTask:e=>{l(e)&&t.splice(r(e),1)},editTask:(e,n,s,o)=>{if(!l(e))return;let a=r(e);null!=n&&(t[a].title=n),null!=s&&(t[a].date=s),null!=o&&(t[a].checked=o)}}})(l))};return{init:()=>{l("Default")},addProject:l,deleteProject:l=>{t(l)&&(e=e.filter((e=>e.name!==l)))},getProjects:()=>e,getProject:t=>{for(let l=0;l<e.length;l++)if(e[l].name===t)return e[l];return null}}})();(()=>{const l=document.querySelector(".js-project-tasks"),r=document.querySelector(".js-project-list"),n=document.querySelector(".js-project-title");let s;const o=e=>{let t=document.createElement("li"),l=document.createElement("span");if(l.classList.add("js-project-item-title"),l.innerText=e,t.appendChild(l),"Default"!==e){let e=document.createElement("button");e.classList.add("js-project-delete-button"),e.addEventListener("click",(e=>{c(e)})),e.style.display="none",t.addEventListener("mouseenter",(e=>{e.currentTarget.querySelector(".js-project-delete-button").style.display="block"})),t.addEventListener("mouseleave",(e=>{e.currentTarget.querySelector(".js-project-delete-button").style.display="none"})),t.appendChild(e)}return t.addEventListener("click",(e=>{a(e)})),e===s&&t.classList.add("project-selected"),t},a=e=>{if("BUTTON"===e.target.nodeName)return;let t=e.currentTarget.querySelector(".js-project-item-title").innerText;t!==s&&(s=t,n.innerText=t,document.querySelector("#js-init-task").style.display="block",u(),k())},c=l=>{let r=l.target.parentElement.querySelector(".js-project-item-title").innerText;t.deleteProject(r),e.saveData(t.getProjects()),r===s&&(n.innerText="",s="",document.querySelector("#js-init-task").style.display="none",k()),u()},d=()=>{document.querySelector("#js-project-form-title").value=""},i=()=>{const l=document.querySelector("#js-project-form-title");null===t.getProject(l.value)&&(t.addProject(l.value),e.saveData(t.getProjects())),d(),u()},u=()=>{r.innerHTML="";let e=t.getProjects();for(let t=0;t<e.length;t++)r.appendChild(o(e[t].name))},m=(e,t,l)=>{let r=document.createElement("li"),n=document.createElement("div");n.classList.add("js-task-info");let s=document.createElement("span"),o=document.createElement("span");s.classList.add("js-task-title"),o.classList.add("js-task-date"),s.innerText=e,o.innerText="Date: ",""!==t.trim()?o.innerText+=t:o.innerText+="None",n.appendChild(s),n.appendChild(o),r.appendChild(n);let a=document.createElement("button");return a.classList.add("js-task-delete-button"),a.addEventListener("click",(e=>{j(e)})),a.style.display="none",r.appendChild(a),r.addEventListener("click",(e=>{y(e)})),r.addEventListener("mouseenter",(e=>{e.currentTarget.querySelector(".js-task-delete-button").style.display="block"})),r.addEventListener("mouseleave",(e=>{e.currentTarget.querySelector(".js-task-delete-button").style.display="none"})),l&&r.classList.add("task-checked"),r},y=l=>{if("BUTTON"===l.target.nodeName)return;let r=l.currentTarget.classList.toggle("task-checked"),n=l.currentTarget.querySelector(".js-task-title").innerText;t.getProject(s).editTask(n,null,null,r),e.saveData(t.getProjects())},j=l=>{let r=l.target.parentElement.querySelector(".js-task-title").innerText;t.getProject(s).removeTask(r),e.saveData(t.getProjects()),k()},p=()=>{const e=document.querySelector("#js-task-form-title"),t=document.querySelector("#js-task-form-date");e.value="",t.value=""},k=()=>{if(l.innerHTML="",""===s)return;let e=t.getProject(s).tasks;for(let t=0;t<e.length;t++)l.appendChild(m(e[t].title,e[t].date,e[t].checked))};return{init:()=>{s="Default",(()=>{t.init();let l=e.loadData();if(null!==l)for(let e of l){t.addProject(e.name);let l=e.tasks,r=t.getProject(e.name);for(let e of l)r.addTask(e.title,e.date,e.checked)}})(),(()=>{const e=document.querySelector("#js-project-list-button"),t=document.querySelector(".sidebar"),l=document.querySelector(".project-body");e.addEventListener("click",(()=>{"none"===t.style.display?(t.style.display="block",l.style.display="none"):(t.style.display="none",l.style.display="flex")}))})(),(()=>{const l=document.querySelector("#js-init-task"),r=document.querySelector(".modal");l.addEventListener("click",(()=>{r.style.display="block"})),window.onclick=e=>{e.target==r&&(p(),r.style.display="none")},document.querySelector(".js-task-form").addEventListener("submit",(l=>{l.preventDefault(),(""!==document.querySelector("#js-task-form-title").value.trim()||(alert("Task title is required"),0))&&((()=>{let l=document.querySelector("#js-task-form-title").value,r=document.querySelector("#js-task-form-date").value;t.getProject(s).addTask(l,r,!1),e.saveData(t.getProjects()),k()})(),p(),r.style.display="none")}))})(),u(),k(),(()=>{const e=document.querySelector("#js-init-project"),t=document.querySelector(".js-project-form");e.style.display="block",t.style.display="none",e.addEventListener("click",(()=>{e.style.display="none",t.style.display="flex"})),document.querySelector("#js-project-form-cancel").addEventListener("click",(()=>{d(),e.style.display="block",t.style.display="none"})),document.querySelector("#js-project-form-confirm").addEventListener("click",(()=>{""!==document.querySelector("#js-project-form-title").value.trim()&&(i(),e.style.display="block",t.style.display="none")}))})()}}})().init()})();